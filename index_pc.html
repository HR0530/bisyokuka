<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ç¾é£Ÿå®¶ã•ã‚“</title>
  <link rel="stylesheet" href="style_pc.css" />
</head>
<body onload="checkLogin(); loadUserSettings(); loadCalorieInfo();">
  <div class="home-page">
    <div class="header-row">
      <div class="profile-section">
        <img id="profileIcon" src="img/user-icon.png" alt="ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³" class="profile-icon">
        <div class="user-name" id="userName">ã“ã‚“ã«ã¡ã¯ã€ç¾é£Ÿå®¶ã•ã‚“ï¼</div>
      </div>
      <div class="header-buttons">
        <button class="settings-button" onclick="window.location.href='settings.html'">âš™ï¸ è¨­å®š</button>
        <button class="logout-button" onclick="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
      </div>
    </div>

    <div class="calorie-card">
      <div class="rank-label">æœ¬æ—¥ã®æ‘‚å–ã‚«ãƒ­ãƒªãƒ¼</div>
      <div class="calorie-value"><span id="calorie">1580</span> kcal</div>
     <div class="rank-sub">ç›®æ¨™ã¾ã§ã‚ã¨ <span id="remainingCalorie">--</span> kcal</div>
    </div>

    <div class="feature-grid">
      <div class="feature-card" onclick="switchPage('meal')">ğŸ“·<br>é£Ÿäº‹è¨˜éŒ²</div>
      <div class="feature-card" onclick="switchPage('fridge')">ğŸ§Š<br>å†·è”µåº«ç®¡ç†</div>
      <div class="feature-card" onclick="switchPage('question')">ğŸ§ <br>è³ªå•ææ¡ˆ</div>
      <div class="feature-card" onclick="switchPage('nutrients')">ğŸ‘¥<br>æ „é¤Šåˆ†æ</div>
      <div class="feature-card" onclick="switchPage('akinator')">ğŸ½ï¸<br>AIçŒ®ç«‹</div>
    </div>
  </div>

  <script>
    function checkLogin() {
      if (localStorage.getItem("loggedIn") !== "true") {
        window.location.href = "login.html";
      }
    }

    function logout() {
      localStorage.removeItem("loggedIn");
      window.location.href = "login.html";
    }

    function switchPage(pageName) {
      window.location.href = `pages/${pageName}/index.html`;
    }

    function loadUserSettings() {
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼åã®åæ˜ 
      const userName = localStorage.getItem("username") || "ç¾é£Ÿå®¶ã•ã‚“";
      document.getElementById("userName").textContent = `ã“ã‚“ã«ã¡ã¯ã€${userName}ï¼`;

      // ã‚«ãƒ­ãƒªãƒ¼ç›®æ¨™ã®åæ˜ 
      const calorieGoal = localStorage.getItem("calorieGoal") || "1580";
      document.getElementById("calorie").textContent = calorieGoal;

      // æ®‹ã‚Šã‚«ãƒ­ãƒªãƒ¼è¡¨ç¤ºï¼ˆä»®ã§ç¾åœ¨æ‘‚å–ï¼1160ã¨ã—ã¦ï¼‰
      const currentCalorie = 1160;
      const remaining = Math.max(0, calorieGoal - currentCalorie);
      document.getElementById("remaining").textContent = `ç›®æ¨™ã¾ã§ã‚ã¨ ${remaining} kcal`;

      // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã®åæ˜ ï¼ˆBase64ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹æƒ³å®šï¼‰
      const userIcon = localStorage.getItem("userIcon");
      if (userIcon) {
        document.getElementById("profileIcon").src = userIcon;
      }
    }
  </script>
</body>
</html>
